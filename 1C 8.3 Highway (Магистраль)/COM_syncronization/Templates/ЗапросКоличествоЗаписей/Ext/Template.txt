// ~25000 записей в 1С:Бухгалтерия
// Время получения данных: 0,2 сек

ВЫБРАТЬ
	ТребованиеНакладнаяМатериалы.Номенклатура КАК Номенклатура,
	СУММА(ТребованиеНакладнаяМатериалы.Количество) КАК Количество,
	ТребованиеНакладная.Склад КАК Склад
ПОМЕСТИТЬ Резервы
ИЗ
	Документ.ТребованиеНакладная.Материалы КАК ТребованиеНакладнаяМатериалы
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ТребованиеНакладная КАК ТребованиеНакладная
		ПО ТребованиеНакладнаяМатериалы.Ссылка = ТребованиеНакладная.Ссылка
ГДЕ
	НЕ ТребованиеНакладная.ПометкаУдаления
	И НЕ ТребованиеНакладная.Проведен
	//И ТребованиеНакладная.Дата > &РезервС
	И ТребованиеНакладная.Дата > ДатаВремя(0001, 01, 01)
	И НЕ ТребованиеНакладная.Склад = ТребованиеНакладная.Субконто2

СГРУППИРОВАТЬ ПО
	ТребованиеНакладная.Склад,
	ТребованиеНакладнаяМатериалы.Номенклатура
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ Количество(*) ИЗ

	//РегистрБухгалтерии.Хозрасчетный.Остатки(&Период, Счет.Код ПОДОБНО "10%", , ) КАК ХозрасчетныйОстатки
	//РегистрБухгалтерии.Хозрасчетный.Остатки(, Счет.Код ПОДОБНО "10%", , ) КАК ХозрасчетныйОстатки
	РегистрБухгалтерии.Хозрасчетный.Остатки(ДатаВремя(0001, 01, 01), Счет.Код ПОДОБНО "10%", , ) КАК ХозрасчетныйОстатки
	
	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Склады КАК СкладыСправочник
		ПО ХозрасчетныйОстатки.Субконто2 = СкладыСправочник.Ссылка

	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК НоменклатураСправочник
		ПО ХозрасчетныйОстатки.Субконто1 = НоменклатураСправочник.Ссылка
	
	ЛЕВОЕ СОЕДИНЕНИЕ Резервы КАК Резервы
		ПО ХозрасчетныйОстатки.Субконто1 = Резервы.Номенклатура
			И ХозрасчетныйОстатки.Субконто2 = Резервы.Склад
ГДЕ НоменклатураСправочник.Код is not null
